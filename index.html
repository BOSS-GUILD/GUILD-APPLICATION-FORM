<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OFFICIAL SECOND BOSS - Free Fire Guild Application 2025</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #ff3e00;
            --secondary: #00c4ff;
            --dark: #0a0e17;
            --light: #ffffff;
            --gray: #7b89a8;
            --background: linear-gradient(135deg, #0a0e17 0%, #1a2639 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Exo 2', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--background);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        .page-container {
            padding: 20px;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ff3e00" fill-opacity="0.05" d="M0,128L48,117.3C96,107,192,85,288,112C384,139,480,213,576,218.7C672,224,768,160,864,138.7C960,117,1056,139,1152,149.3C1248,160,1344,160,1392,160L1440,160L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') no-repeat bottom;
            background-size: cover;
            z-index: -1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
        }

        header {
            text-align: center;
            padding: 30px 0;
            margin-bottom: 40px;
            background: rgba(10, 14, 23, 0.8);
            border-radius: 20px;
            border-bottom: 3px solid var(--primary);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            position: relative;
            overflow: hidden;
        }

        header::after {
            content: '2025';
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--secondary);
            opacity: 0.7;
        }

        .logo {
            margin-bottom: 15px;
            display: flex;
            justify-content: center;
        }

        .logo img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 15px rgba(255, 215, 0, 0.6); }
            50% { box-shadow: 0 0 25px rgba(255, 215, 0, 0.9); }
            100% { box-shadow: 0 0 15px rgba(255, 215, 0, 0.6); }
        }

        h1 {
            font-size: 3rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .subtitle {
            color: var(--gray);
            margin-top: 10px;
            font-size: 1.2rem;
        }

        .content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
        }

        .guild-info {
            flex: 1;
            background: rgba(10, 14, 23, 0.8);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 62, 0, 0.2);
            position: relative;
            overflow: hidden;
        }

        .guild-info::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(to bottom, var(--primary), var(--secondary));
        }

        .guild-info h2 {
            color: var(--secondary);
            margin-bottom: 20px;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 10px;
            font-size: 1.8rem;
        }

        .requirements {
            margin-top: 25px;
            padding: 20px;
            background: rgba(255, 62, 0, 0.08);
            border-radius: 15px;
            border-left: 3px solid var(--primary);
        }

        .requirements li {
            margin-bottom: 10px;
            list-style-type: none;
            padding-left: 30px;
            position: relative;
        }

        .requirements li:before {
            content: "➤";
            color: var(--primary);
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        .social-links {
            margin-top: 30px;
            text-align: center;
        }

        .social-links a {
            display: inline-block;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: #000;
            padding: 12px 25px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s;
            margin: 5px;
            box-shadow: 0 5px 15px rgba(255, 62, 0, 0.3);
        }

        .social-links a:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(255, 62, 0, 0.5);
        }

        .application-form {
            flex: 1;
            background: rgba(10, 14, 23, 0.8);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(0, 196, 255, 0.2);
            position: relative;
        }

        .application-form h2 {
            color: var(--secondary);
            margin-bottom: 25px;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 10px;
            font-size: 1.8rem;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
            color: var(--gray);
        }

        input,
        select,
        textarea {
            width: 100%;
            padding: 15px 20px;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.07);
            color: var(--light);
            font-size: 16px;
            transition: all 0.3s;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--primary);
            box-shadow: 0 0 15px rgba(255, 62, 0, 0.2);
        }

        .contact-option {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }

        .contact-option label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            transition: all 0.3s;
        }

        .contact-option label:hover {
            background: rgba(255, 62, 0, 0.1);
        }

        .contact-option input[type="radio"] {
            width: auto;
        }

        button {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: #000;
            border: none;
            padding: 18px 30px;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(255, 62, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: 0.5s;
        }

        button:hover::before {
            left: 100%;
        }

        button:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(255, 62, 0, 0.5);
        }

        footer {
            text-align: center;
            padding: 30px;
            margin-top: 40px;
            background: rgba(10, 14, 23, 0.8);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border-top: 1px solid rgba(255, 62, 0, 0.2);
        }

        .creator {
            margin-top: 15px;
            color: var(--gray);
            font-size: 1rem;
        }

        .creator a {
            color: var(--secondary);
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s;
        }

        .creator a:hover {
            text-decoration: underline;
        }
        
        .footer-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .footer-admin-btn, .btn-secondary {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: #000;
            padding: 10px 20px;
            border-radius: 50px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            width: auto;
            font-size: 1rem;
            margin-top: 0;
        }

        .btn-secondary {
            background: none;
            border: 1px solid var(--secondary);
            color: var(--secondary);
        }

        .footer-admin-btn:hover, .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(255, 62, 0, 0.3);
        }

        .btn-secondary:hover {
            background: var(--secondary);
            color: var(--dark);
            box-shadow: 0 6px 15px rgba(0, 196, 255, 0.3);
        }

        @media (max-width: 900px) {
            .content { flex-direction: column; }
            h1 { font-size: 2.2rem; }
            .logo { font-size: 3rem; }
        }

        .spinner { display: none; width: 50px; height: 50px; margin: 20px auto; border: 4px solid rgba(255, 255, 255, 0.1); border-radius: 50%; border-top: 4px solid var(--primary); animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .success-message { display: none; text-align: center; padding: 30px; background: rgba(0, 200, 0, 0.1); border-radius: 15px; margin-top: 25px; border-left: 4px solid #00cc66; }
        .success-message i { font-size: 3rem; color: #00cc66; margin-bottom: 15px; }

        .particles { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; overflow: hidden; }
        .particle { position: absolute; background: var(--primary); border-radius: 50%; opacity: 0.3; animation: float 15s infinite linear; }
        @keyframes float { 0% { transform: translateY(100vh) translateX(0); opacity: 0; } 10% { opacity: 0.3; } 100% { transform: translateY(-100vh) translateX(20vw); opacity: 0; } }

        .form-highlight { position: absolute; width: 200px; height: 200px; background: radial-gradient(circle, var(--secondary) 0%, transparent 70%); opacity: 0.05; border-radius: 50%; z-index: 0; }
        
        /* LOGIN & MODAL STYLES */
        #loginPage, #queryModal { display: none; flex-direction: column; justify-content: center; align-items: center; min-height: 100vh; }
        .modal-container, .login-form-container { width: 100%; max-width: 450px; }
        .modal-form, .login-form { background: rgba(10, 14, 23, 0.95); padding: 40px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6); text-align: center; border: 1px solid var(--primary); }
        .modal-form h2, .login-form h2 { margin-bottom: 25px; color: var(--secondary); font-size: 2rem; }
        .modal-form input, .login-form input, .modal-form textarea { width: 100%; padding: 12px 15px; margin-bottom: 20px; border: none; border-radius: 8px; background: rgba(255, 255, 255, 0.1); color: white; font-size: 16px; }
        .modal-form button, .login-form button { width: 100%; padding: 12px; }
        .back-to-site { margin-top: 20px; color: var(--gray); text-decoration: none; transition: color 0.3s; display: inline-block; }
        .back-to-site:hover { color: var(--light); }

        /* ADMIN PANEL STYLES */
        .logout-container { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .logout-container button { background: linear-gradient(to right, var(--primary), var(--secondary)); color: #000; padding: 8px 16px; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); width: auto; font-size: 0.9rem; margin: 0; }
        .logout-container button:hover { transform: translateY(-2px); box-shadow: 0 6px 15px rgba(255, 62, 0, 0.3); }
        .app-list { display: grid; gap: 20px; }
        .applicant-card, .query-card { background: rgba(10, 14, 23, 0.8); border-radius: 15px; padding: 20px; border: 1px solid rgba(255, 62, 0, 0.2); box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4); }
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px; }
        .info-item { background: rgba(0, 0, 0, 0.2); padding: 10px; border-radius: 8px; }
        .info-label { font-weight: 500; color: var(--gray); font-size: 0.9rem; margin-bottom: 5px; }
        .info-value { color: var(--light); word-wrap: break-word; }
        .info-value a { color: var(--secondary); text-decoration: none; font-weight: bold; }
        .info-value a:hover { text-decoration: underline; }
        .admin-tabs { display: flex; gap: 10px; border-bottom: none; }
        .admin-tab { background: linear-gradient(to right, var(--primary), var(--secondary)); color: #000; padding: 8px 16px; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); opacity: 0.7; }
        .admin-tab:hover { opacity: 1; transform: translateY(-2px); }
        .admin-tab.active { opacity: 1; transform: scale(1.05); box-shadow: 0 6px 15px rgba(255, 62, 0, 0.3); }
        .admin-tab-content { padding-top: 20px; }
        .action-buttons { margin-top: 20px; display: flex; gap: 10px; }
        .action-buttons button, .query-card button { width: 50%; padding: 10px; font-size: 1rem; font-weight: bold; }
        .btn-accept { background: linear-gradient(to right, #00b09b, #96c93d); }
        .btn-reject, .btn-delete-query { background: linear-gradient(to right, #ff512f, #dd2476); }
        .no-apps-message { padding: 40px; text-align: center; color: var(--gray); background: rgba(0, 0, 0, 0.2); border-radius: 10px; margin-top: 20px; }
        .admin-controls { display: flex; gap: 15px; margin-bottom: 20px; align-items: center; flex-wrap: wrap; }
        #acceptedSearchInput, #sortAcceptedSelect, #pendingSearchInput, #sortPendingSelect { padding: 10px 15px; background: rgba(0,0,0,0.2); border: 1px solid var(--gray); border-radius: 8px; color: var(--light); font-size: 0.9rem; }
        #acceptedSearchInput, #pendingSearchInput { flex-grow: 1; }
        .btn-export { width: auto; padding: 10px 20px; font-size: 1rem; background: linear-gradient(to right, #00b09b, #96c93d); margin-bottom: 0; }
        .ingame-status-container { margin-top: 20px; border-top: 1px solid var(--gray); padding-top: 15px; }
        .ingame-status-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .ingame-status-text { font-weight: bold; }
        .status-added { color: #28a745; }
        .status-not-added { color: #ffc107; }
        .btn-mark-added, .btn-unmark { width: auto; padding: 8px 12px; font-size: 0.8rem; }
        .btn-mark-added { background: var(--secondary); }
        .btn-unmark { background: var(--gray); color: var(--light); }
        .ingame-note-textarea { width: 100%; min-height: 60px; margin-top: 5px; }
        .btn-save-note { width: auto; padding: 8px 15px; font-size: 0.9rem; margin-top: 10px; background: var(--secondary); }
        .query-card .info-value { font-style: italic; white-space: pre-wrap; }
        .query-card .info-item { display: flex; justify-content: space-between; align-items: center; }
        .btn-delete-query { width: auto; font-size: 0.9rem; padding: 8px 15px; }
    </style>
</head>
<body>
    <div class="particles" id="particles"></div>

    <div id="mainContent" class="page-container">
        <div class="container">
            <header>
                <div class="logo">
                    <img src="BOSS GUILD LOGO.jpg" alt="Guild Logo">
                </div>
                <h1>OFFICIAL SECOND BOSS GUILD 2025</h1>
                <p class="subtitle">Join the elite Free Fire fighting force of the future</p>
            </header>
            <div class="content">
                <div class="guild-info">
                    <div class="form-highlight" style="top: -50px; right: -50px;"></div>
                    <h2>About Our Guild</h2>
                    <p>This is OFFICIAL SECOND BOSS and the guild is now looking for players who can complete the daily glory of 2000 which is mandatory and also requires to play guild wars. Also there are rewards for players who does highest glory.</p>
                    <div class="requirements">
                        <h3>Guild Requirements:</h3>
                        <ul>
                            <li><strong>Minimum Level: 70</strong></li>
                            <li>Daily Glory: 2000</li>
                            <li>Mandatory Name Change</li>
                            <li>Respectful behavior to guild members</li>
                            <li>Regular activity (inactivity for 7+ days may result in removal)</li>
                            <li>Must have microphone for voice communication</li>
                            <li>Weekly training sessions are mandatory</li>
                        </ul>
                    </div>
                    <div class="social-links">
                        <a href="https://www.instagram.com/boss_tarak07?igsh=azc5MWNsYjZmZmw1" target="_blank">
                            <i class="fab fa-instagram"></i> Follow us on Instagram
                        </a>
                    </div>
                </div>
                <div class="application-form">
                    <h2>Guild Application Form</h2>
                    <form id="guildForm">
                        <div class="form-group">
                            <label for="uid">Free Fire UID:</label>
                            <input type="text" id="uid" name="uid" required placeholder="e.g., 1234567890">
                        </div>
                        <div class="form-group">
                            <label for="gameName">Game Name:</label>
                            <input type="text" id="gameName" name="gameName" required placeholder="Enter your in-game name">
                        </div>
                        <div class="form-group">
                            <label for="level">Player Level:</label>
                            <input type="number" id="level" name="level" required min="70" max="200" placeholder="Enter level (70+)">
                        </div>
                        <div class="form-group">
                            <label for="experience">Gameplay Experience (in years):</label>
                            <input type="number" id="experience" name="experience" required min="0" step="0.5" placeholder="e.g., 2.5">
                        </div>
                        <div class="form-group">
                            <label>Contact Method:</label>
                            <div class="contact-option">
                                <label><input type="radio" name="contactMethod" value="instagram" checked> <i class="fab fa-instagram"></i> Instagram</label>
                                <label><input type="radio" name="contactMethod" value="whatsapp"> <i class="fab fa-whatsapp"></i> WhatsApp</label>
                            </div>
                        </div>
                        <div class="form-group" id="contactInfo">
                            <label for="instagram">Instagram Username:</label>
                            <input type="text" id="instagram" name="instagram" placeholder="e.g., @yourusername" required>
                        </div>
                        <div class="form-group">
                            <label for="message">Additional Message (optional):</label>
                            <textarea id="message" name="message" rows="4" placeholder="Tell us about your style..."></textarea>
                        </div>
                        <button type="submit">Submit Application</button>
                        <div class="spinner" id="spinner"></div>
                        <div class="success-message" id="successMessage">
                            <i class="fas fa-check-circle"></i>
                            <h3>Application Submitted Successfully!</h3>
                            <p>We will review your application and contact you soon.</p>
                        </div>
                    </form>
                </div>
            </div>
            <footer>
                <p>© 2025 OFFICIAL SECOND BOSS Free Fire Guild. All rights reserved.</p>
                <p>This site is not officially affiliated with Garena Free Fire.</p>
                <p class="creator">Created by <a href="https://www.instagram.com/yashwanth_reddy_0007/" target="_blank" rel="noopener noreferrer"><span>Yashwanth Reddy</span></a></p>
                <div class="footer-buttons">
                    <button class="footer-admin-btn" onclick="showLoginPage()">Admin Login</button>
                    <button class="btn-secondary" onclick="showQueryModal()">Suggestions & Queries</button>
                </div>
            </footer>
        </div>
    </div>

    <div id="loginPage" class="page-container" style="display: none;">
        <div class="login-form-container">
            <div class="login-form">
                <h2>Admin Login</h2>
                <input type="password" id="password" placeholder="Enter password" autocomplete="current-password">
                <button onclick="login()">Login</button>
                <p id="loginError" style="color: #ff3e00; margin-top: 10px; display: none;">❌ Wrong password!</p>
                <a href="#" onclick="showMainPage()" class="back-to-site">← Back to Main Site</a>
            </div>
        </div>
    </div>

    <div id="queryModal" class="page-container" style="display: none;">
        <div class="modal-container">
            <form id="queryForm" class="modal-form">
                <h2>Suggestions & Queries</h2>
                <div class="form-group">
                    <label for="query_message">Your Message:</label>
                    <textarea id="query_message" name="query_message" rows="5" required placeholder="Enter your suggestion or question..."></textarea>
                </div>
                <div class="form-group">
                    <label>Your Preferred Contact Method:</label>
                    <div class="contact-option">
                        <label><input type="radio" name="queryContactMethod" value="instagram" checked> <i class="fab fa-instagram"></i> Instagram</label>
                        <label><input type="radio" name="queryContactMethod" value="whatsapp"> <i class="fab fa-whatsapp"></i> WhatsApp</label>
                    </div>
                </div>
                <div class="form-group" id="queryContactInfo">
                    <label for="query_instagram">Instagram Username:</label>
                    <input type="text" id="query_instagram" name="query_instagram" placeholder="e.g., @yourusername" required>
                </div>
                <button type="submit">Send Message</button>
                <a href="#" onclick="closeQueryModal()" class="back-to-site">← Back to Main Site</a>
            </form>
        </div>
    </div>

    <div id="adminPanel" class="page-container" style="display: none;">
        <div class="container">
            <header style="margin-bottom: 20px; text-align: center;">
                <h1>OFFICIAL SECOND BOSS GUILD ADMIN PANEL</h1>
            </header>
            <div class="logout-container">
                <div class="admin-tabs">
                    <button id="pendingTab" class="admin-tab active">Pending</button>
                    <button id="acceptedTab" class="admin-tab">Accepted</button>
                    <button id="queriesTab" class="admin-tab">Queries</button>
                </div>
                <button onclick="logout()">Logout</button>
            </div>
            <div id="pendingContent" class="admin-tab-content">
                <div class="admin-controls">
                    <input type="text" id="pendingSearchInput" placeholder="Search pending by UID...">
                    <select id="sortPendingSelect">
                        <option value="recent">Sort by Date (Newest)</option>
                        <option value="level_high">Sort by Level (Highest)</option>
                        <option value="level_low">Sort by Level (Lowest)</option>
                    </select>
                </div>
                <div id="pendingList" class="app-list"></div>
            </div>
            <div id="acceptedContent" class="admin-tab-content" style="display: none;">
                <div class="admin-controls">
                    <input type="text" id="acceptedSearchInput" placeholder="Search accepted by UID...">
                    <select id="sortAcceptedSelect">
                        <option value="recent">Sort by Date (Default)</option>
                        <option value="inguild">Show 'In Guild' First</option>
                        <option value="notinguild">Show 'Not in Guild' First</option>
                    </select>
                    <button id="exportCsvBtn" class="btn-export">Export to CSV</button>
                </div>
                <div id="acceptedList" class="app-list"></div>
            </div>
            <div id="queriesContent" class="admin-tab-content" style="display: none;">
                <div id="queriesList" class="app-list"></div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, getDocs, addDoc, query, orderBy, where, doc, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCo7jqNnRC3ve71JSEPhz5vxUtOUCay-vM",
            authDomain: "boss-guild-application.firebaseapp.com",
            projectId: "boss-guild-application",
            storageBucket: "boss-guild-application.appspot.com",
            messagingSenderId: "939540989156",
            appId: "1:939540989156:web:e92569c1a8173a4a33d8f1",
            measurementId: "G-SLG1TEF5PX"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        const mainContent = document.getElementById('mainContent');
        const loginPage = document.getElementById('loginPage');
        const adminPanel = document.getElementById('adminPanel');
        const guildForm = document.getElementById('guildForm');
        const queryModal = document.getElementById('queryModal');
        const queryForm = document.getElementById('queryForm');
        const pendingList = document.getElementById('pendingList');
        const acceptedList = document.getElementById('acceptedList');
        const queriesList = document.getElementById('queriesList');
        const pendingTab = document.getElementById('pendingTab');
        const acceptedTab = document.getElementById('acceptedTab');
        const queriesTab = document.getElementById('queriesTab');
        const pendingContent = document.getElementById('pendingContent');
        const acceptedContent = document.getElementById('acceptedContent');
        const queriesContent = document.getElementById('queriesContent');
        const ADMIN_PASSWORD = "bosstarak07";

        function showMainPage() { mainContent.style.display = 'block'; loginPage.style.display = 'none'; adminPanel.style.display = 'none'; queryModal.style.display = 'none'; }
        function showLoginPage() { mainContent.style.display = 'none'; loginPage.style.display = 'flex'; adminPanel.style.display = 'none'; document.getElementById('loginError').style.display = 'none'; document.getElementById('password').value = ''; document.getElementById('password').focus(); }
        function showAdminPanel() { mainContent.style.display = 'none'; loginPage.style.display = 'none'; adminPanel.style.display = 'block'; }
        function showQueryModal() { queryModal.style.display = 'flex'; mainContent.style.display = 'none'; }
        function closeQueryModal() { queryModal.style.display = 'none'; mainContent.style.display = 'block'; }
        
        function getContactDetail(data, isQuery = false) {
            const contactMethod = isQuery ? data.contactMethod : data.contactMethod;
            const contactDetail = isQuery ? data.contactDetail : (data.contactMethod === 'whatsapp' ? data.whatsapp : data.instagram);
            if (contactMethod === 'whatsapp' && contactDetail) {
                const phoneNumber = contactDetail.replace(/\D/g, '');
                return `<a href="https://wa.me/${phoneNumber}" target="_blank" rel="noopener noreferrer">${contactDetail}</a>`;
            }
            if (contactMethod === 'instagram' && contactDetail) {
                const username = contactDetail.replace(/@/g, '');
                return `<a href="https://instagram.com/${username}" target="_blank" rel="noopener noreferrer">${contactDetail}</a>`;
            }
            return 'Not provided';
        }
        
        async function loadAdminData() {
            try {
                const pendingQuery = query(collection(db, 'applications'), where('status', '==', 'pending'));
                const pendingSnapshot = await getDocs(pendingQuery);
                renderApplications(pendingSnapshot, pendingList, true);

                const acceptedQuery = query(collection(db, 'applications'), where('status', '==', 'accepted'));
                const acceptedSnapshot = await getDocs(acceptedQuery);
                renderApplications(acceptedSnapshot, acceptedList, false);

                const queriesQuery = query(collection(db, 'queries'), orderBy('timestamp', 'desc'));
                const queriesSnapshot = await getDocs(queriesQuery);
                renderQueries(queriesSnapshot);
                
                sortAndFilterPending();
                sortAndFilterAccepted();
            } catch (error) {
                console.error("Error loading data:", error);
                pendingList.innerHTML = `<div class="no-apps-message">Error loading data. Check Firestore rules.</div>`;
            }
        }
        
        function renderApplications(snapshot, listElement, areActionsVisible) {
            if (snapshot.empty) { listElement.innerHTML = `<div class="no-apps-message">No applications in this category.</div>`; return; }
            listElement.innerHTML = snapshot.docs.map(doc => {
                const app = { id: doc.id, ...doc.data() };
                const submittedDate = app.timestamp ? new Date(app.timestamp).toLocaleString() : 'N/A';
                const inGameStatus = app.ingame_status || 'not_added';
                const statusText = inGameStatus === 'added' ? 'In Guild' : 'Not in Guild';
                const statusClass = inGameStatus === 'added' ? 'status-added' : 'status-not-added';
                const acceptedMemberControls = `...`; // Omitted for brevity
                return `...`; // Omitted for brevity
            }).join('');
        }

        function renderQueries(snapshot) {
            if (snapshot.empty) { queriesList.innerHTML = `<div class="no-apps-message">No queries or suggestions yet.</div>`; return; }
            queriesList.innerHTML = snapshot.docs.map(doc => {
                const query = { id: doc.id, ...doc.data() };
                const submittedDate = query.timestamp ? new Date(query.timestamp).toLocaleString() : 'N/A';
                return `
                <div class="query-card" id="${query.id}">
                    <div class="info-item">
                        <div class="info-label">Submitted: ${submittedDate}</div>
                        <div class="info-value">${query.message}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Contact: ${getContactDetail(query, true)}</div>
                        <button class="btn-delete-query" onclick="deleteQuery('${query.id}')">Delete</button>
                    </div>
                </div>`;
            }).join('');
        }
        
        guildForm.addEventListener('submit', async function(e) { /* ... Omitted for brevity ... */ });

        queryForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            const contactMethod = formData.get('queryContactMethod');
            const data = {
                message: formData.get('query_message'),
                contactMethod: contactMethod,
                contactDetail: contactMethod === 'instagram' ? formData.get('query_instagram') : formData.get('query_whatsapp'),
                timestamp: new Date().toISOString()
            };
            try {
                await addDoc(collection(db, 'queries'), data);
                alert('Thank you! Your message has been sent.');
                this.reset();
                closeQueryModal();
            } catch (error) {
                console.error("Query submission error:", error);
                alert('Sorry, there was an error sending your message.');
            }
        });
        
        async function acceptApplication(docId) { /* ... Omitted for brevity ... */ }
        async function rejectApplication(docId) { /* ... Omitted for brevity ... */ }
        async function markAsAdded(docId) { /* ... Omitted for brevity ... */ }
        async function unmarkAsAdded(docId) { /* ... Omitted for brevity ... */ }
        async function saveIngameNote(docId) { /* ... Omitted for brevity ... */ }
        async function deleteQuery(docId) {
            if (confirm('Are you sure you want to delete this query?')) {
                const queryRef = doc(db, 'queries', docId);
                try {
                    await deleteDoc(queryRef);
                    loadAdminData();
                } catch (error) {
                    console.error("Error deleting query:", error);
                    alert("Could not delete query.");
                }
            }
        }
        
        function login() {
            const password = document.getElementById('password').value;
            if (password === ADMIN_PASSWORD) {
                showAdminPanel();
                loadAdminData();
            } else {
                document.getElementById('loginError').style.display = 'block';
            }
        }
        
        document.getElementById('password').addEventListener('keyup', (event) => { if (event.key === 'Enter') login(); });
        function logout() { showMainPage(); }

        pendingTab.addEventListener('click', () => {
            pendingTab.classList.add('active'); acceptedTab.classList.remove('active'); queriesTab.classList.remove('active');
            pendingContent.style.display = 'block'; acceptedContent.style.display = 'none'; queriesContent.style.display = 'none';
        });
        acceptedTab.addEventListener('click', () => {
            pendingTab.classList.remove('active'); acceptedTab.classList.add('active'); queriesTab.classList.remove('active');
            pendingContent.style.display = 'none'; acceptedContent.style.display = 'block'; queriesContent.style.display = 'none';
        });
        queriesTab.addEventListener('click', () => {
            pendingTab.classList.remove('active'); acceptedTab.classList.remove('active'); queriesTab.classList.add('active');
            pendingContent.style.display = 'none'; acceptedContent.style.display = 'none'; queriesContent.style.display = 'block';
        });

        const exportCsvBtn = document.getElementById('exportCsvBtn');
        exportCsvBtn.addEventListener('click', async () => { /* ... Omitted for brevity ... */ });
        const acceptedSearchInput = document.getElementById('acceptedSearchInput');
        const sortAcceptedSelect = document.getElementById('sortAcceptedSelect');
        const pendingSearchInput = document.getElementById('pendingSearchInput');
        const sortPendingSelect = document.getElementById('sortPendingSelect');
        acceptedSearchInput.addEventListener('input', sortAndFilterAccepted);
        sortAcceptedSelect.addEventListener('change', sortAndFilterAccepted);
        pendingSearchInput.addEventListener('input', sortAndFilterPending);
        sortPendingSelect.addEventListener('change', sortAndFilterPending);
        function sortAndFilterAccepted() { /* ... Omitted for brevity ... */ }
        function sortAndFilterPending() { /* ... Omitted for brevity ... */ }
        function createParticles() { /* ... Omitted for brevity ... */ }
        function updateContactField() { /* ... Omitted for brevity ... */ }

        function updateQueryContactField() {
            const selected = document.querySelector('input[name="queryContactMethod"]:checked').value;
            const container = document.getElementById('queryContactInfo');
            if (selected === 'whatsapp') {
                container.innerHTML = `<label for="query_whatsapp">WhatsApp Number:</label><input type="tel" id="query_whatsapp" name="query_whatsapp" placeholder="e.g., +91..." required>`;
            } else {
                container.innerHTML = `<label for="query_instagram">Instagram Username:</label><input type="text" id="query_instagram" name="query_instagram" placeholder="e.g., @yourusername" required>`;
            }
        }
        
        window.showMainPage = showMainPage; window.showLoginPage = showLoginPage; window.showQueryModal = showQueryModal; window.closeQueryModal = closeQueryModal;
        window.login = login; window.logout = logout;
        window.acceptApplication = acceptApplication; window.rejectApplication = rejectApplication;
        window.markAsAdded = markAsAdded; window.unmarkAsAdded = unmarkAsAdded; window.saveIngameNote = saveIngameNote;
        window.deleteQuery = deleteQuery;

        window.onload = function() {
            createParticles();
            updateContactField();
            updateQueryContactField();
            document.querySelectorAll('input[name="contactMethod"]').forEach(radio => { radio.addEventListener('change', updateContactField); });
            document.querySelectorAll('input[name="queryContactMethod"]').forEach(radio => { radio.addEventListener('change', updateQueryContactField); });
        };
    </script>
</body>
</html>

*For brevity, I have collapsed some of the larger JavaScript functions that were unchanged, like `renderApplications`, `sortAndFilter`, etc. The actual code is identical to the last full version I provided.*
